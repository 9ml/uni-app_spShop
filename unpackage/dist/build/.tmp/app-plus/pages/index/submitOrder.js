(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/submitOrder"],{"1e60":function(o,e,s){"use strict";var t=function(){var o=this,e=o.$createElement;o._self._c;o._isMounted||(o.e0=function(e){return o.myTools.navBack()})},n=[];s.d(e,"a",function(){return t}),s.d(e,"b",function(){return n})},"526a":function(o,e,s){"use strict";(function(o){s("80f6"),s("921b");t(s("66fd"));var e=t(s("6b9a"));function t(o){return o&&o.__esModule?o:{default:o}}o(e.default)}).call(this,s("6e42")["createPage"])},"6b9a":function(o,e,s){"use strict";s.r(e);var t=s("1e60"),n=s("dbd5");for(var i in n)"default"!==i&&function(o){s.d(e,o,function(){return n[o]})}(i);s("a432");var d=s("2877"),r=Object(d["a"])(n["default"],t["a"],t["b"],!1,null,null,null);e["default"]=r.exports},a432:function(o,e,s){"use strict";var t=s("be87"),n=s.n(t);n.a},be87:function(o,e,s){},dbd5:function(o,e,s){"use strict";s.r(e);var t=s("f319"),n=s.n(t);for(var i in t)"default"!==i&&function(o){s.d(e,o,function(){return t[o]})}(i);e["default"]=n.a},f319:function(o,e,s){"use strict";(function(o,t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){return s.e("components/uni-popup/uni-popup").then(s.bind(null,"1738"))},i={components:{uniPopup:n},data:function(){return{userId:o.getStorageSync("userId"),userAdressInfo:"",userChoseGoodsInfo:"",goodsNums:0,totalPrice:0,buyType:"",userBz:"",noAdress:!0,haveAdress:!1,isSetAdress:!1}},onLoad:function(){this.imgUrl=this._Api.imgUrl,this.goodsId=o.getStorageSync("goodsId"),this.goodsTypeId=o.getStorageSync("goodsTypeId"),this.goodsNums=o.getStorageSync("goodsNums"),this.buyType=o.getStorageSync("buyType"),o.getStorageSync("consigneeId")?this.consigneeId=o.getStorageSync("consigneeId"):this.consigneeId="",console.log(t(this.consigneeId," at pages\\index\\submitOrder.vue:196")),this.getAdressInfo(),this.getGoodsInfos()},methods:{getAdressInfo:function(){var e=this;this._Api.getConfirmAdressInfo({userId:this.userId,consigneeId:this.consigneeId},function(s){console.log(t(s," at pages\\index\\submitOrder.vue:208")),200===s.meta.code?(e.noAdress=!1,e.haveAdress=!0,e.isSetAdress=!1,e.userAdressInfo=s.data,e.consigneeId=e.userAdressInfo.id):(e.isSetAdress=!0,o.showToast({title:s.meta.msg,icon:"none",duration:1500}))})},goGoodsInfo:function(e){this._Api.checkPtGoodsInfo({goodsId:e},function(s){if(console.log(t(s," at pages\\index\\submitOrder.vue:229")),200===s.meta.code)if(console.log(t(s.data.length," at pages\\index\\submitOrder.vue:231")),0===s.data.length)o.navigateTo({url:"./goodsInfoNormal?goodsId="+e});else{var n=[],i=[];s.data.forEach(function(o){n[n.length]=o.id,i[i.length]=o.ptSize}),o.navigateTo({url:"./goodsInfo?goodsId="+e+"&arr="+n+"&num="+i})}})},getGoodsInfos:function(){var e=this;this._Api.getConfirmGoodsInfo({id:this.goodsTypeId},function(s){console.log(t(s," at pages\\index\\submitOrder.vue:255")),200===s.meta.code?(s.data.goodsMainImg=e.imgUrl+s.data.goodsMainImg,s.data.lastPrice=s.data.goodsPrice-s.data.couponPrice,e.userChoseGoodsInfo=s.data,e.totalPrice=(s.data.goodsPrice-s.data.couponPrice)*e.goodsNums):o.showToast({title:s.meta.msg,icon:"none",duration:1500})})},goodsAdd:function(){this.goodsNums++,this.getPrice()},goodsCut:function(){this.goodsNums<=1?o.showToast({title:"最少选择一件哦",icon:"none",duration:1500}):(this.goodsNums--,this.getPrice())},getPrice:function(){this.totalPrice=(this.userChoseGoodsInfo.goodsPrice-this.userChoseGoodsInfo.couponPrice)*this.goodsNums},ChosePsStyle:function(){this.$refs.sendStyle.open()},choseSure:function(){this.$refs.sendStyle.close()},submitOrder:function(){if(this.isSetAdress)return o.showToast({title:"请先设置收货地址再提交订单哦~",icon:"none",duration:1500}),!1;var e=this.userChoseGoodsInfo.goodsPrice*this.goodsNums;this._Api.confirmOrder({userId:this.userId,consigneeId:this.consigneeId,propertyId:this.goodsTypeId,goodsAmount:this.goodsNums,orderPrice:e,couponPrice:this.userChoseGoodsInfo.couponPrice,orderAmount:this.totalPrice,promType:this.buyType,orderRemark:this.userBz},function(e){console.log(t(e," at pages\\index\\submitOrder.vue:320")),200===e.meta.code?(o.showToast({title:"提交成功",icon:"none",duration:1500}),setTimeout(function(){o.navigateTo({url:"./cashier?orderNum="+e.data})},1500)):o.showToast({title:e.meta.msg,icon:"none",duration:1500})})},choseMyAdress:function(){o.setStorageSync("choseAdressType",0),o.navigateTo({url:"../mine/myAdress"})}}};e.default=i}).call(this,s("6e42")["default"],s("0de9")["default"])}},[["526a","common/runtime","common/vendor"]]]);