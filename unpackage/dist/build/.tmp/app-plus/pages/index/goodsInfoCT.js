(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/goodsInfoCT"],{"2bfa":function(o,s,t){"use strict";var e,i=function(){var o=this,s=o.$createElement;o._self._c;o._isMounted||(o.e0=function(s){return o.myTools.navBack()},o.e1=function(s){return o.myTools.navBack()})},n=[];t.d(s,"b",function(){return i}),t.d(s,"c",function(){return n}),t.d(s,"a",function(){return e})},4154:function(o,s,t){},4998:function(o,s,t){"use strict";var e=t("4154"),i=t.n(e);i.a},b39a:function(o,s,t){"use strict";(function(o,e){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var i=function(){return t.e("components/uni-popup/uni-popup").then(t.bind(null,"3ed9"))},n={components:{uniPopup:i},data:function(){return{userId:o.getStorageSync("userId"),isShow:!1,goodsInfo:"",bannerList:[],tiledDisplay:[],fabricDisplay:[],evaluateAll:[],evaluateFirst:"",evaluateImg:[],isevaluate:!0,colorList:[],sizeList:[],current_c:0,current_s:0,choseMiniShow:"",isChoseColor:"",isChoseSize:"",goodsStock:"",buyNum:1,buyType:"",goodsTypeId:0,isShowUp:0,isCollectionIcon:"../../static/icon_sc.png",isCollectionFonts:"收藏",ptingInfo:"",isPTingOver:!0,isHaveColor:!1,isHaveSize:!1}},onLoad:function(o){this.goodsId=o.goodsId,this.ptInfoTableId=o.ptInfoTableId,this.ptGoodsTableId=o.ptGoodsTableId,this.imgUrl=this._Api.imgUrl,this.goodsDesc(),this.evaluates(),this.getGoodsColor(),this.getPtingInfo()},onBackPress:function(s){return 1===this.isShowUp?(this.$refs.shares.close(),this.$refs.choseType.close(),this.$refs.cans.close(),this.isShowUp=0,!0):(o.setStorageSync("goodsId",0),o.setStorageSync("ptInfoTableId",0),o.setStorageSync("ptGoodsTableId",0),!1)},methods:{onPageScroll:function(o){o.scrollTop>=70?this.isShow=!0:this.isShow=!1},goodsDesc:function(){var s=this;this._Api.shopDesc({goodsId:this.goodsId},function(t){console.log(e(t," at pages\\index\\goodsInfoCT.vue:447")),200===t.meta.code?(t.data.lastPrice=s.myTools.countPrice(t.data.goodsPrice,t.data.goodsDiscount),t.data.goodsMainImg=s.imgUrl+t.data.goodsMainImg,t.data.goodsSizes=t.data.goodsSizes.substr(1),s.goodsInfo=t.data,s.isCollection(),s.bannerList=s.myTools.imgAddUrl(t.data.goodsImg,s.imgUrl),s.tiledDisplay=s.myTools.imgAddUrl(t.data.tileShow,s.imgUrl),s.fabricDisplay=s.myTools.imgAddUrl(t.data.shellFarbic,s.imgUrl)):o.showToast({title:t.msg,icon:"none",duration:1500})})},getPtingInfo:function(){var s=this;this._Api.showPtInfoTableInfo({ptInfoTableId:this.ptInfoTableId},function(t){if(console.log(e(t," at pages\\index\\goodsInfoCT.vue:471")),200===t.meta.code)if(t.data){-1!=t.data.userImg.indexOf("http")||(t.data.userImg=s.imgUrl+t.data.userImg);var i=(new Date).getTime(),n=new Date(t.data.sustainTime).getTime();t.data.dayTimes=s.myTools.timesChange(n-i)[0],t.data.hoursTimes=s.myTools.timesChange(n-i)[1],t.data.minutesTimes=s.myTools.timesChange(n-i)[2],t.data.secondsTimes=s.myTools.timesChange(n-i)[3],t.data.timer=setInterval(function(){t.data.secondsTimes--,t.data.secondsTimes<=0&&(t.data.minutesTimes--,t.data.secondsTimes=60,t.data.minutesTimes<=0&&(s.getPtingInfo(),clearInterval(t.data.timer)))},1e3),s.ptingInfo=t.data}else s.isPTingOver=!1,o.showModal({title:"提示",content:"您来晚了哦,此团已完成或拼团时效已到",success:function(s){s.confirm?o.reLaunch({url:"/pages/index/index"}):s.cancel&&o.reLaunch({url:"/pages/index/index"})}});else o.showToast({title:t.meta.msg,icon:"none",duration:1500})})},evaluates:function(){var s=this;this._Api.evaluate({goodsId:this.goodsId},function(t){console.log(e(t," at pages\\index\\goodsInfoCT.vue:527")),200===t.meta.code?(s.evaluateAll=t.data,0!==t.data.length?(-1!=t.data[0].userImg.indexOf("http")||(t.data[0].userImg=s.imgUrl+t.data[0].userImg),s.evaluateImg=s.myTools.imgAddUrl(t.data[0].evenluationImg,s.imgUrl),s.evaluateFirst=t.data[0],s.evaluateFirst.createTime=s.myTools.formatDateTime(s.evaluateFirst.createTime,"str")):(s.isevaluate=!1,s.evaluateImg=[])):o.showToast({title:t.msg,icon:"none",duration:1500})})},getGoodsColor:function(){var s=this;this._Api.getColors({goodsId:this.goodsId},function(t){console.log(e(t," at pages\\index\\goodsInfoCT.vue:555")),200===t.meta.code?(0===t.data.length||t.data.forEach(function(o){o.goodsColor&&(s.isHaveColor=!0,s.isChoseColor=t.data[0].goodsColor)}),s.colorList=t.data,s.getGoodsSize()):o.showToast({title:t.meta.msg,icon:"none",duration:1500})})},getGoodsSize:function(){var s=this;this._Api.getSizes({goodsId:this.goodsId,goodsColor:this.isChoseColor},function(t){console.log(e(t," at pages\\index\\goodsInfoCT.vue:582")),200===t.meta.code?(0===t.data.length||t.data.forEach(function(o){o.goodsSize&&(s.isHaveSize=!0,s.changeSize(0,t.data[0].goodsSize),s.goodsStock=t.data[0].goodsInventory)}),s.sizeList=t.data):o.showToast({title:t.meta.msg,icon:"none",duration:1500})})},buyCTing:function(){this.buyType=1,this.isShowUp=1,this.$refs.choseType.open()},goPTing:function(){this.buyType=1,this.isShowUp=1,this.$refs.choseType.open()},addMyShopCar:function(){this.buyType=2,this.isShowUp=1,this.$refs.choseType.open()},changeColor:function(o,s){this.current_c=o,this.isChoseColor=s,this.choseMiniShow=this.colorList[o].goodsImg,this.getGoodsSize()},lookAllComment:function(){o.navigateTo({url:"./allComment?goodsId="+this.goodsId})},changeSize:function(o,s){this.current_s=o,this.isChoseSize=s},cutNums:function(){this.buyNum<=1?o.showToast({title:"不能再少了哦",icon:"none",duration:1500}):this.buyNum--},addNums:function(){this.buyNum++},isCollection:function(){var o=this;this.userId&&this._Api.isCollect({userId:this.userId,goodsId:this.goodsId},function(s){console.log(e(s," at pages\\index\\goodsInfoCT.vue:659")),200===s.meta.code&&(o.isCollectionIcon="../../static/icon_ysc.png",o.isCollectionFonts="已收藏")})},isLogin:function(){var s=this;o.showModal({title:"提示",content:"您未登录，是否去登录？",success:function(t){t.confirm?(o.setStorageSync("goodsId",s.goodsId),o.setStorageSync("ptInfoTableId",s.ptInfoTableId),o.setStorageSync("ptGoodsTableId",s.ptGoodsTableId),o.redirectTo({url:"../user/login"})):t.cancel}})},collection:function(){var s=this;this.userId?"已收藏"==this.isCollectionFonts?o.showModal({title:"提示",content:"是否取消收藏",success:function(t){t.confirm?s._Api.userDelCollection({userId:s.userId,goodsId:s.goodsId},function(t){console.log(e(t," at pages\\index\\goodsInfoCT.vue:701")),200===t.meta.code?(o.showToast({title:"取消收藏成功",icon:"none",duration:1500}),s.isCollectionIcon="../../static/icon_sc.png",s.isCollectionFonts="收藏"):o.showToast({title:t.meta.msg,icon:"none",duration:1500})}):t.cancel}}):this._Api.userCollection({userId:this.userId,goodsId:this.goodsId},function(t){console.log(e(t," at pages\\index\\goodsInfoCT.vue:728")),200===t.meta.code?(s.isCollectionIcon="../../static/icon_ysc.png",s.isCollectionFonts="已收藏",o.showToast({title:"收藏成功",icon:"none",duration:1500})):o.showToast({title:t.meta.msg,icon:"none",duration:1500})}):this.isLogin()},goBuy:function(){var s=this;if(this.userId){for(var t=0;t<this.sizeList.length;t++)this.sizeList[t].goodsColor==this.isChoseColor&&this.sizeList[t].goodsSize==this.isChoseSize&&(this.goodsTypeId=this.sizeList[t].id);1===this.buyType?(o.setStorageSync("goodsId",this.goodsId),o.setStorageSync("goodsTypeId",this.goodsTypeId),o.setStorageSync("goodsNums",this.buyNum),o.setStorageSync("buyType",this.buyType),o.setStorageSync("ctTypeId",this.ptInfoTableId),o.setStorageSync("ptType",this.ptGoodsTableId),o.navigateTo({url:"./submitOrderCT"})):2===this.buyType&&this._Api.addShopCar({userId:this.userId,goodsId:this.goodsId,propertyId:this.goodsTypeId,goodsAmount:this.buyNum},function(t){200===t.meta.code?(s.$refs.choseType.close(),s.isShowUp=0,o.showToast({title:"加入成功,请在我的购物车查看",icon:"none",duration:1500})):(s.$refs.choseType.close(),o.showToast({title:t.meta.msg,icon:"none",duration:1500}))})}else this.$refs.choseType.close(),this.isShowUp=0,this.isLogin()},shares:function(){this.$refs.shares.open(),this.isShowUp=1},closeShare:function(){this.$refs.shares.close(),this.isShowUp=0},cans:function(){this.$refs.cans.open(),this.isShowUp=1},closeCans:function(){this.$refs.cans.close(),this.isShowUp=0},closeCT:function(){this.$refs.choseType.close(),this.isShowUp=0},goKF:function(){this.userId?o.navigateTo({url:"/pages/mine/curstomerService"}):this.isLogin()},shareWeChat:function(){this.userId?o.share({provider:"weixin",scene:"WXSceneSession",type:0,href:"http://47.104.185.192:8080/didi/share.html?goodsId="+this.goodsInfo.id,title:"尚品商城",summary:"这件商品不错哦，快来看看吧~",imageUrl:this.goodsInfo.goodsMainImg,success:function(o){console.log(e("success:"+JSON.stringify(o)," at pages\\index\\goodsInfoCT.vue:849"))},fail:function(o){console.log(e("fail:"+JSON.stringify(o)," at pages\\index\\goodsInfoCT.vue:852"))}}):this.isLogin()},shareCircleOfFriends:function(){this.userId?o.share({provider:"weixin",scene:"WXSenceTimeline",type:0,href:"http://47.104.185.192:8080/didi/share.html?goodsId="+this.goodsInfo.id,title:"尚品商城",summary:"这件商品不错哦，快来看看吧~",imageUrl:this.goodsInfo.goodsMainImg,success:function(o){console.log(e("success:"+JSON.stringify(o)," at pages\\index\\goodsInfoCT.vue:871"))},fail:function(o){console.log(e("fail:"+JSON.stringify(o)," at pages\\index\\goodsInfoCT.vue:874"))}}):this.isLogin()}}};s.default=n}).call(this,t("6e42")["default"],t("0de9")["default"])},cb31:function(o,s,t){"use strict";t.r(s);var e=t("2bfa"),i=t("d9fd");for(var n in i)"default"!==n&&function(o){t.d(s,o,function(){return i[o]})}(n);t("4998");var a,d=t("f0c5"),c=Object(d["a"])(i["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],a);s["default"]=c.exports},d9fd:function(o,s,t){"use strict";t.r(s);var e=t("b39a"),i=t.n(e);for(var n in e)"default"!==n&&function(o){t.d(s,o,function(){return e[o]})}(n);s["default"]=i.a},f32e:function(o,s,t){"use strict";(function(o){t("1b93"),t("921b");e(t("66fd"));var s=e(t("cb31"));function e(o){return o&&o.__esModule?o:{default:o}}o(s.default)}).call(this,t("6e42")["createPage"])}},[["f32e","common/runtime","common/vendor"]]]);